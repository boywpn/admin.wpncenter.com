/*!
 * jQuery Simple Color Picker v1.0
 * https://github.com/tomreid76/jquery-simplecolorpicker
 *
 * Copyright 2013 Tom Reid
 * Released under the MIT license
 */
;(function($,window){var SimpleColorPicker=function(el,opts){this.$el=$(el);this.options=opts;this.metadata=eval(this.$el.data("options"))};SimpleColorPicker.prototype={defaults:{defaultColor:{name:"default (white)",hex:"fff"},borderWidth:1,cellWidth:20,cellHeight:20,cellBorder:1,elWidth:25,elHeight:25,cols:5,colors:[{name:"brown",hex:"7a4100"},{name:"green",hex:"00aa00"},{name:"red",hex:"cc0000"},{name:"aqua",hex:"039799"},{name:"pink",hex:"b0307a"},{name:"purple",hex:"762ca7"},{name:"orange",hex:"cc6600"},{name:"gray",hex:"555555"},{name:"black",hex:"000000"},{name:"blue",hex:"0000dd"}],iconPos:"right",aniSpeed:50,lsClass:"color-picker-chooser",textCurrentColor:"Current color: "},init:function(){var e=this;e.config=$.extend(true,{},e.defaults,e.options,e.metadata);e.config.totalWidth=e.config.cols*(e.config.cellWidth+2*e.config.cellBorder);e.config.totalHeight=Math.ceil(e.config.colors.length/e.config.cols)*(e.config.cellHeight+2*e.config.cellBorder);e.setupInputElement();e.$cp=e.getPickerMenu();$("body").append(e.$cp);e.bindPickerEvents();$(window).resize(function(){e.setPickerPosition(e.$cp)});return e},geticonPos:function(){var e;switch(this.config.iconPos){case"center":e="center";break;case"left":e="4px center";break;case"right":default:e=this.config.elWidth-20+"px";break}return e},setupInputElement:function(){var e=this,t=e.$el.val()&&e.$el.val()!==""?e.$el.val():e.config.defaultColor.hex;e.$el.css({backgroundColor:"#"+t,backgroundPosition:e.geticonPos(),borderWidth:e.config.borderWidth+"px",width:e.config.elWidth+"px",height:e.config.elHeight+"px",color:"#"+e.$el.val()})},close:function(){var e=this;e.$cp.slideUp(e.config.aniSpeed).find("li").removeClass("selected");e.$el.removeClass("open").focus();$(document).off("mouseup.cp"+e.colorPickerInstance,"html")},open:function(){var e=this;e.setPickerPosition(e.$cp);e.$el.addClass("open");e.$cp.slideDown(e.config.aniSpeed);$(document).on("mouseup.cp"+e.colorPickerInstance,"html",function(){e.close.call(e)})},setPickerPosition:function(e){var t=this,n=t.$el.offset(),r=t.$el.height();e.css({top:n.top+r+t.config.borderWidth,left:n.left})},getCells:function(){var e=this,t=e.config.colors.length,n=$("<div/>"),r,i;for(r=0;r<t;r++){i=$("<li tabindex='0' title='"+e.config.colors[r].name+"' data-color='"+e.config.colors[r].hex+"'></li>");i.css({width:e.config.cellWidth+"px",height:e.config.cellHeight+"px",borderWidth:e.config.cellBorder+"px",backgroundColor:"#"+e.config.colors[r].hex});n.append(i)}return n},getPickerMenu:function(){var e=this;e.colorPickerInstance=$("."+e.config.lsClass).length+1;var t=$("<ul class='"+e.config.lsClass+"' id='cp-"+e.colorPickerInstance+"' />"),n;e.setPickerPosition(t);t.css({borderWidth:e.config.borderWidth+"px",width:e.config.totalWidth+"px",height:e.config.totalHeight+"px",display:"none"});n=e.getCells();t.append(n.children());return t},bindPickerEvents:function(){var e=this,t=e.$cp.find("li");e.$el.bind({mouseup:function(t){e.$cp.is(":visible")?e.close():e.open();t.stopPropagation()},keydown:function(t){switch(t.which){case 13:e.$el.trigger("mouseup");break;case 27:e.close();t.stopPropagation();break;case 40:e.open();e.$cp.find("li:first").focus().addClass("selected");break;case 9:if(e.$cp.is(":visible")){e.$cp.find("li:first").focus().addClass("selected");t.preventDefault()}break}}});t.bind({keydown:function(t){var n=$(this),r=n.siblings().andSelf();switch(t.which){case 13:n.trigger("mouseup");break;case 27:n.removeClass("selected");e.close();t.stopPropagation();break;case 37:if(n.prevAll().length===0){n.removeClass("selected").siblings(":last").focus().addClass("selected")}else{n.removeClass("selected").prev().focus().addClass("selected")}break;case 38:var i=r.index(n)-e.config.cols;if(i>-1){n.removeClass("selected");$(r[i]).addClass("selected").focus()}else{n.removeClass("selected");e.close()}break;case 39:case 9:if(n.nextAll().length===0){n.removeClass("selected").siblings(":first").focus().addClass("selected")}else{n.removeClass("selected").next().focus().addClass("selected")}break;case 40:var s=r.index(n)+e.config.cols;if(s<r.length){n.removeClass("selected");$(r[s]).addClass("selected").focus()}break}return false},mouseup:function(t){var n=$(this);n.siblings().andSelf().removeClass("selected");var r=n.attr("data-color"),i=n.attr("title");e.$el.val(r).removeClass("open").focus().css({backgroundColor:"#"+r,color:"#"+r}).attr("title",e.config.textCurrentColor+i);e.close();t.stopPropagation();return false}})}};$.fn.simpleColorPicker=function(e){return this.each(function(){(new SimpleColorPicker(this,e)).init()})}})(jQuery,window);